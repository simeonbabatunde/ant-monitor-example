<!--
  ~  This file is part of AntMonitor <https://athinagroup.eng.uci.edu/projects/antmonitor/>.
  ~  Copyright (C) 2018 Anastasia Shuba and the UCI Networking Group
  ~  <https://athinagroup.eng.uci.edu>, University of California, Irvine.
  ~
  ~  AntMonitor is free software: you can redistribute it and/or modify
  ~  it under the terms of the GNU General Public License as published by
  ~  the Free Software Foundation, either version 2 of the License, or
  ~  (at your option) any later version.
  ~
  ~  AntMonitor is distributed in the hope that it will be useful,
  ~  but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~  GNU General Public License for more details.
  ~
  ~  You should have received a copy of the GNU General Public License
  ~  along with AntMonitor. If not, see <http://www.gnu.org/licenses/>.
  -->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_161) on Tue Nov 13 10:57:13 PST 2018 -->
<title>PcapngFile</title>
<meta name="date" content="2018-11-13">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PcapngFile";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PacketDumpInfo.html" title="class in edu.uci.calit2.antmonitor.lib.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/Protocol.html" title="enum in edu.uci.calit2.antmonitor.lib.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?edu/uci/calit2/antmonitor/lib/util/PcapngFile.html" target="_top">Frames</a></li>
<li><a href="PcapngFile.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.uci.calit2.antmonitor.lib.util</div>
<h2 title="Class PcapngFile" class="title">Class PcapngFile</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>edu.uci.calit2.antmonitor.lib.util.PcapngFile</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">PcapngFile</span>
extends java.lang.Object</pre>
<div class="block">Represents a single PCAPNG file.
 <p>
 This implementation of PCAPNG follows the IETF internet-draft from June 26, 2014 by M. Tuxen, et al. Please note
 that this specification is a work in progress and as such it cannot be guaranteed that the specification has changed
 since this implementation.
 For the latest PCAPNG specification consult IETF.org's <a href="https://datatracker.ietf.org/doc/search/?name=pcapng&rfcs=on&activedrafts=on&olddrafts=on&sort=" target="_blank">Data Tracker</a>.
</p>
 <p>
 The underlying write buffer for the file associated with an instance of this class is guarded by a lock to ensure
 thread safety when modifying the associated file.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#PcapngFile-java.io.File-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-long-int-java.lang.String-long-byte-">PcapngFile</a></span>(java.io.File&nbsp;file,
          java.lang.String&nbsp;headerComment,
          java.lang.String&nbsp;hardwareInfo,
          java.lang.String&nbsp;osInfo,
          java.lang.String&nbsp;appInfo,
          java.lang.String&nbsp;ifName,
          java.lang.String&nbsp;ifDescription,
          java.lang.String&nbsp;ifIPAddr,
          java.lang.String&nbsp;ifMacAddr,
          long&nbsp;ifSpeed,
          int&nbsp;ifTimezone,
          java.lang.String&nbsp;ifFilter,
          long&nbsp;tsOffset,
          byte&nbsp;tsRes)</code>
<div class="block">This constructor creates a new file on the filesystem and writes a Section Header Block (SHB) and a Interface Description Block (IDB) to the beginning of the file.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#appendEnhancedPacketBlock-long-int-int-byte:A-java.lang.String-">appendEnhancedPacketBlock</a></span>(long&nbsp;timestamp,
                         int&nbsp;capturedLength,
                         int&nbsp;originalLength,
                         byte[]&nbsp;packet,
                         java.lang.String&nbsp;comment)</code>
<div class="block">Create an Enhanced Packet Block (EPB) and append it to the current file.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.io.File</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#getFile--">getFile</a></span>()</code>
<div class="block">A getter for the file that currently represents this PCAPNG file.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#getSectionLength--">getSectionLength</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#isFileEmpty--">isFileEmpty</a></span>()</code>
<div class="block">Determines whether or not this file contains any packets.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PcapngFile.html#renameAndEndFile-java.io.File-">renameAndEndFile</a></span>(java.io.File&nbsp;newFile)</code>
<div class="block">Closes the underlying <code>FileOutputStream</code> and renames the file to that of the specified file</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PcapngFile-java.io.File-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-long-int-java.lang.String-long-byte-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PcapngFile</h4>
<pre>public&nbsp;PcapngFile(java.io.File&nbsp;file,
                  java.lang.String&nbsp;headerComment,
                  java.lang.String&nbsp;hardwareInfo,
                  java.lang.String&nbsp;osInfo,
                  java.lang.String&nbsp;appInfo,
                  java.lang.String&nbsp;ifName,
                  java.lang.String&nbsp;ifDescription,
                  java.lang.String&nbsp;ifIPAddr,
                  java.lang.String&nbsp;ifMacAddr,
                  long&nbsp;ifSpeed,
                  int&nbsp;ifTimezone,
                  java.lang.String&nbsp;ifFilter,
                  long&nbsp;tsOffset,
                  byte&nbsp;tsRes)
           throws java.io.FileNotFoundException</pre>
<div class="block">This constructor creates a new file on the filesystem and writes a Section Header Block (SHB) and a Interface Description Block (IDB) to the beginning of the file.
 Note that specifying an already existing file, will result in the SHB and IDB to be appended to the end of the specified file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>file</code> - The file to write the data to</dd>
<dd><code>headerComment</code> - SHB option meant to contain information not captured by other options. eg. session / installation ID.</dd>
<dd><code>hardwareInfo</code> - SHB option for capturing information about the hardware on which the packets were captured.</dd>
<dd><code>osInfo</code> - SHB option for capturing information about the OS</dd>
<dd><code>appInfo</code> - SHB option describing information about the application</dd>
<dd><code>ifName</code> - IDB option containing the name of the network interface</dd>
<dd><code>ifDescription</code> - IDB option containing a description of the network interface</dd>
<dd><code>ifIPAddr</code> - IDB option with the IP address of the interface.</dd>
<dd><code>ifMacAddr</code> - IDB option containing the mac address of the network interface</dd>
<dd><code>ifSpeed</code> - IDB option containing the speed of the network connection in bps.</dd>
<dd><code>ifTimezone</code> - IDB option - current time zone</dd>
<dd><code>ifFilter</code> - IDB option - The filter which was used while the packets were captured</dd>
<dd><code>tsOffset</code> - IDB option - tsOffset - Timezone offset</dd>
<dd><code>tsRes</code> - IDB option - Resolution of the timestamp - default value is 6 which denotes a timescale of 10^6. For milliseconds this value should be 3.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.FileNotFoundException</code> - If the <code>file</code> does not exist.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="appendEnhancedPacketBlock-long-int-int-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>appendEnhancedPacketBlock</h4>
<pre>public&nbsp;void&nbsp;appendEnhancedPacketBlock(long&nbsp;timestamp,
                                      int&nbsp;capturedLength,
                                      int&nbsp;originalLength,
                                      byte[]&nbsp;packet,
                                      java.lang.String&nbsp;comment)</pre>
<div class="block">Create an Enhanced Packet Block (EPB) and append it to the current file. This method also updates the section length 32 bit word of the previous SHB with the added length of this packet block.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp for when the packet was captured. This should adhere to the format specified in the IDB.</dd>
<dd><code>capturedLength</code> - The number of bytes captured from the packet. (padding not included).</dd>
<dd><code>originalLength</code> - The length of the original packet as it was sent on the wire.</dd>
<dd><code>packet</code> - The packet</dd>
<dd><code>comment</code> - a comment about the packet captured. An example hereof could the name of the application from which the packet was intercepted.</dd>
</dl>
</li>
</ul>
<a name="getFile--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFile</h4>
<pre>public&nbsp;java.io.File&nbsp;getFile()</pre>
<div class="block">A getter for the file that currently represents this PCAPNG file.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the file.</dd>
</dl>
</li>
</ul>
<a name="renameAndEndFile-java.io.File-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>renameAndEndFile</h4>
<pre>public&nbsp;void&nbsp;renameAndEndFile(java.io.File&nbsp;newFile)</pre>
<div class="block">Closes the underlying <code>FileOutputStream</code> and renames the file to that of the specified file</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newFile</code> - a file containing the name/path of the final file.</dd>
</dl>
</li>
</ul>
<a name="isFileEmpty--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isFileEmpty</h4>
<pre>public&nbsp;boolean&nbsp;isFileEmpty()</pre>
<div class="block">Determines whether or not this file contains any packets.
 In case there is only a SHB and IDB defined (or none), this will return true</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if no EHB blocks has been appended. Otherwise false.</dd>
</dl>
</li>
</ul>
<a name="getSectionLength--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getSectionLength</h4>
<pre>public&nbsp;long&nbsp;getSectionLength()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/PacketDumpInfo.html" title="class in edu.uci.calit2.antmonitor.lib.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../edu/uci/calit2/antmonitor/lib/util/Protocol.html" title="enum in edu.uci.calit2.antmonitor.lib.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?edu/uci/calit2/antmonitor/lib/util/PcapngFile.html" target="_top">Frames</a></li>
<li><a href="PcapngFile.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
